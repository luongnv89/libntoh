\hypertarget{ipv4defrag_8c}{\section{ipv4defrag.\-c File Reference}
\label{ipv4defrag_8c}\index{ipv4defrag.\-c@{ipv4defrag.\-c}}
}
{\ttfamily \#include $<$stdio.\-h$>$}\\*
{\ttfamily \#include $<$stdlib.\-h$>$}\\*
{\ttfamily \#include $<$string.\-h$>$}\\*
{\ttfamily \#include $<$unistd.\-h$>$}\\*
{\ttfamily \#include $<$sys/time.\-h$>$}\\*
{\ttfamily \#include $<$libntoh.\-h$>$}\\*
Include dependency graph for ipv4defrag.\-c\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{ipv4defrag_8c__incl}
\end{center}
\end{figure}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{ipv4defrag_8c_a0e25ec3d9c374c5e6dceeb9341baf766}{\-\_\-\-\_\-\-F\-A\-V\-O\-R\-\_\-\-B\-S\-D}
\item 
\#define \hyperlink{ipv4defrag_8c_a8eda6fbf0769d50aca5bae2f174cb0b5}{N\-T\-O\-H\-\_\-\-G\-E\-T\-\_\-\-I\-P\-V4\-\_\-\-F\-R\-A\-G\-M\-E\-N\-T\-\_\-\-O\-F\-F\-S\-E\-T}(offset)~(8$\ast$(ntohs(offset)\&I\-P\-\_\-\-O\-F\-F\-M\-A\-S\-K))
\item 
\#define \hyperlink{ipv4defrag_8c_a43b7201050790177c6210907f0cbbdf9}{I\-S\-\_\-\-S\-E\-T}(a, b)~(a \& b)
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
unsigned int \hyperlink{ipv4defrag_8c_a01f1e9c4a39e170cfa4ec308a31faffb}{ntoh\-\_\-ipv4\-\_\-get\-\_\-size} (\hyperlink{ipv4defrag_8h_afc5621c261daa52b33985ffbd2272c55}{pntoh\-\_\-ipv4\-\_\-session\-\_\-t} session)
\begin{DoxyCompactList}\small\item\em A\-P\-I to get the size of the flows table (max allowed flows) \end{DoxyCompactList}\item 
unsigned int \hyperlink{ipv4defrag_8c_a39f759aeaf8f8996bba28ed367bdb221}{ntoh\-\_\-ipv4\-\_\-get\-\_\-tuple4} (struct ip $\ast$ip, \hyperlink{ipv4defrag_8h_a76aaf532036b8514a7236adefeaecc43}{pntoh\-\_\-ipv4\-\_\-tuple4\-\_\-t} tuple)
\begin{DoxyCompactList}\small\item\em A\-P\-I to get a tuple4. \end{DoxyCompactList}\item 
\hyperlink{ipv4defrag_8h_a3f660efd6002e587a68fdf5bbdec4016}{pntoh\-\_\-ipv4\-\_\-flow\-\_\-t} \hyperlink{ipv4defrag_8c_a3520b0d7dce72f58c175205cf1689802}{ntoh\-\_\-ipv4\-\_\-find\-\_\-flow} (\hyperlink{ipv4defrag_8h_afc5621c261daa52b33985ffbd2272c55}{pntoh\-\_\-ipv4\-\_\-session\-\_\-t} session, \hyperlink{ipv4defrag_8h_a76aaf532036b8514a7236adefeaecc43}{pntoh\-\_\-ipv4\-\_\-tuple4\-\_\-t} tuple4)
\begin{DoxyCompactList}\small\item\em Finds an I\-P flow. \end{DoxyCompactList}\item 
\hyperlink{ipv4defrag_8h_a3f660efd6002e587a68fdf5bbdec4016}{pntoh\-\_\-ipv4\-\_\-flow\-\_\-t} \hyperlink{ipv4defrag_8c_a6b71240da1885ddbd1cff5927f2434c0}{ntoh\-\_\-ipv4\-\_\-new\-\_\-flow} (\hyperlink{ipv4defrag_8h_afc5621c261daa52b33985ffbd2272c55}{pntoh\-\_\-ipv4\-\_\-session\-\_\-t} session, \hyperlink{ipv4defrag_8h_a76aaf532036b8514a7236adefeaecc43}{pntoh\-\_\-ipv4\-\_\-tuple4\-\_\-t} tuple4, \hyperlink{ipv4defrag_8h_aa23bc358947efae2e4b4e5d975cdb111}{pipv4\-\_\-dfcallback\-\_\-t} function, void $\ast$udata, unsigned int $\ast$error)
\begin{DoxyCompactList}\small\item\em Adds a new I\-Pv4 flow. \end{DoxyCompactList}\item 
void \hyperlink{ipv4defrag_8c_a42e5f462e83ced7f73ac615e0eb7e4ab}{ntoh\-\_\-ipv4\-\_\-free\-\_\-flow} (\hyperlink{ipv4defrag_8h_afc5621c261daa52b33985ffbd2272c55}{pntoh\-\_\-ipv4\-\_\-session\-\_\-t} session, \hyperlink{ipv4defrag_8h_a3f660efd6002e587a68fdf5bbdec4016}{pntoh\-\_\-ipv4\-\_\-flow\-\_\-t} $\ast$flow, unsigned short reason)
\begin{DoxyCompactList}\small\item\em Frees an I\-Pv4 flow. \end{DoxyCompactList}\item 
int \hyperlink{ipv4defrag_8c_a93f29473cc605a67ced28ed4cabd2c59}{ntoh\-\_\-ipv4\-\_\-add\-\_\-fragment} (\hyperlink{ipv4defrag_8h_afc5621c261daa52b33985ffbd2272c55}{pntoh\-\_\-ipv4\-\_\-session\-\_\-t} session, \hyperlink{ipv4defrag_8h_a3f660efd6002e587a68fdf5bbdec4016}{pntoh\-\_\-ipv4\-\_\-flow\-\_\-t} flow, struct ip $\ast$iphdr, size\-\_\-t len)
\begin{DoxyCompactList}\small\item\em Adds a new I\-Pv4 fragment to a given flow. \end{DoxyCompactList}\item 
unsigned int \hyperlink{ipv4defrag_8c_acf5643df2e4d6a1fe0477a18fc8487ce}{ntoh\-\_\-ipv4\-\_\-count\-\_\-flows} (\hyperlink{ipv4defrag_8h_afc5621c261daa52b33985ffbd2272c55}{pntoh\-\_\-ipv4\-\_\-session\-\_\-t} session)
\begin{DoxyCompactList}\small\item\em Returns the total count of flows stored in the global hash table. \end{DoxyCompactList}\item 
\hyperlink{ipv4defrag_8h_afc5621c261daa52b33985ffbd2272c55}{pntoh\-\_\-ipv4\-\_\-session\-\_\-t} \hyperlink{ipv4defrag_8c_a747aa58cdf0daac73c2ea82aa336e8ce}{ntoh\-\_\-ipv4\-\_\-new\-\_\-session} (unsigned int max\-\_\-flows, unsigned long max\-\_\-mem, unsigned int $\ast$error)
\begin{DoxyCompactList}\small\item\em Creates a new session with independent parameters to reassemble T\-C\-P segments. \end{DoxyCompactList}\item 
void \hyperlink{ipv4defrag_8c_a9d8470322a5accf2ad4bed6edf9d79c3}{ntoh\-\_\-ipv4\-\_\-free\-\_\-session} (\hyperlink{ipv4defrag_8h_afc5621c261daa52b33985ffbd2272c55}{pntoh\-\_\-ipv4\-\_\-session\-\_\-t} session)
\begin{DoxyCompactList}\small\item\em Releases all resources used by an I\-Pv4 session. \end{DoxyCompactList}\item 
void \hyperlink{ipv4defrag_8c_a8fd4011f06ea8b38964d324be07cf35e}{ntoh\-\_\-ipv4\-\_\-init} (void)
\begin{DoxyCompactList}\small\item\em Initializes the I\-Pv4 defragmentation. \end{DoxyCompactList}\item 
void \hyperlink{ipv4defrag_8c_adb63592a0e2a53aec9fae9e117a681a1}{ntoh\-\_\-ipv4\-\_\-exit} (void)
\begin{DoxyCompactList}\small\item\em Flush all I\-Pv4 sessions and release all resources. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\hypertarget{ipv4defrag_8c_a0e25ec3d9c374c5e6dceeb9341baf766}{\index{ipv4defrag.\-c@{ipv4defrag.\-c}!\-\_\-\-\_\-\-F\-A\-V\-O\-R\-\_\-\-B\-S\-D@{\-\_\-\-\_\-\-F\-A\-V\-O\-R\-\_\-\-B\-S\-D}}
\index{\-\_\-\-\_\-\-F\-A\-V\-O\-R\-\_\-\-B\-S\-D@{\-\_\-\-\_\-\-F\-A\-V\-O\-R\-\_\-\-B\-S\-D}!ipv4defrag.c@{ipv4defrag.\-c}}
\subsubsection[{\-\_\-\-\_\-\-F\-A\-V\-O\-R\-\_\-\-B\-S\-D}]{\setlength{\rightskip}{0pt plus 5cm}\#define \-\_\-\-\_\-\-F\-A\-V\-O\-R\-\_\-\-B\-S\-D}}\label{ipv4defrag_8c_a0e25ec3d9c374c5e6dceeb9341baf766}
\hypertarget{ipv4defrag_8c_a43b7201050790177c6210907f0cbbdf9}{\index{ipv4defrag.\-c@{ipv4defrag.\-c}!I\-S\-\_\-\-S\-E\-T@{I\-S\-\_\-\-S\-E\-T}}
\index{I\-S\-\_\-\-S\-E\-T@{I\-S\-\_\-\-S\-E\-T}!ipv4defrag.c@{ipv4defrag.\-c}}
\subsubsection[{I\-S\-\_\-\-S\-E\-T}]{\setlength{\rightskip}{0pt plus 5cm}\#define I\-S\-\_\-\-S\-E\-T(
\begin{DoxyParamCaption}
\item[{}]{a, }
\item[{}]{b}
\end{DoxyParamCaption}
)~(a \& b)}}\label{ipv4defrag_8c_a43b7201050790177c6210907f0cbbdf9}
\hypertarget{ipv4defrag_8c_a8eda6fbf0769d50aca5bae2f174cb0b5}{\index{ipv4defrag.\-c@{ipv4defrag.\-c}!N\-T\-O\-H\-\_\-\-G\-E\-T\-\_\-\-I\-P\-V4\-\_\-\-F\-R\-A\-G\-M\-E\-N\-T\-\_\-\-O\-F\-F\-S\-E\-T@{N\-T\-O\-H\-\_\-\-G\-E\-T\-\_\-\-I\-P\-V4\-\_\-\-F\-R\-A\-G\-M\-E\-N\-T\-\_\-\-O\-F\-F\-S\-E\-T}}
\index{N\-T\-O\-H\-\_\-\-G\-E\-T\-\_\-\-I\-P\-V4\-\_\-\-F\-R\-A\-G\-M\-E\-N\-T\-\_\-\-O\-F\-F\-S\-E\-T@{N\-T\-O\-H\-\_\-\-G\-E\-T\-\_\-\-I\-P\-V4\-\_\-\-F\-R\-A\-G\-M\-E\-N\-T\-\_\-\-O\-F\-F\-S\-E\-T}!ipv4defrag.c@{ipv4defrag.\-c}}
\subsubsection[{N\-T\-O\-H\-\_\-\-G\-E\-T\-\_\-\-I\-P\-V4\-\_\-\-F\-R\-A\-G\-M\-E\-N\-T\-\_\-\-O\-F\-F\-S\-E\-T}]{\setlength{\rightskip}{0pt plus 5cm}\#define N\-T\-O\-H\-\_\-\-G\-E\-T\-\_\-\-I\-P\-V4\-\_\-\-F\-R\-A\-G\-M\-E\-N\-T\-\_\-\-O\-F\-F\-S\-E\-T(
\begin{DoxyParamCaption}
\item[{}]{offset}
\end{DoxyParamCaption}
)~(8$\ast$(ntohs(offset)\&I\-P\-\_\-\-O\-F\-F\-M\-A\-S\-K))}}\label{ipv4defrag_8c_a8eda6fbf0769d50aca5bae2f174cb0b5}


\subsection{Function Documentation}
\hypertarget{ipv4defrag_8c_a93f29473cc605a67ced28ed4cabd2c59}{\index{ipv4defrag.\-c@{ipv4defrag.\-c}!ntoh\-\_\-ipv4\-\_\-add\-\_\-fragment@{ntoh\-\_\-ipv4\-\_\-add\-\_\-fragment}}
\index{ntoh\-\_\-ipv4\-\_\-add\-\_\-fragment@{ntoh\-\_\-ipv4\-\_\-add\-\_\-fragment}!ipv4defrag.c@{ipv4defrag.\-c}}
\subsubsection[{ntoh\-\_\-ipv4\-\_\-add\-\_\-fragment}]{\setlength{\rightskip}{0pt plus 5cm}int ntoh\-\_\-ipv4\-\_\-add\-\_\-fragment (
\begin{DoxyParamCaption}
\item[{{\bf pntoh\-\_\-ipv4\-\_\-session\-\_\-t}}]{session, }
\item[{{\bf pntoh\-\_\-ipv4\-\_\-flow\-\_\-t}}]{flow, }
\item[{struct ip $\ast$}]{iphdr, }
\item[{size\-\_\-t}]{len}
\end{DoxyParamCaption}
)}}\label{ipv4defrag_8c_a93f29473cc605a67ced28ed4cabd2c59}


Adds a new I\-Pv4 fragment to a given flow. 


\begin{DoxyParams}{Parameters}
{\em flow} & Flow where the new fragment will be added \\
\hline
{\em iphdr} & I\-Pv4 Header of the fragment \\
\hline
{\em len} & Length of the fragment (I\-Pv4 header + payload) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
N\-T\-O\-H\-\_\-\-O\-K on success, or error code when it fails 
\end{DoxyReturn}
\hypertarget{ipv4defrag_8c_acf5643df2e4d6a1fe0477a18fc8487ce}{\index{ipv4defrag.\-c@{ipv4defrag.\-c}!ntoh\-\_\-ipv4\-\_\-count\-\_\-flows@{ntoh\-\_\-ipv4\-\_\-count\-\_\-flows}}
\index{ntoh\-\_\-ipv4\-\_\-count\-\_\-flows@{ntoh\-\_\-ipv4\-\_\-count\-\_\-flows}!ipv4defrag.c@{ipv4defrag.\-c}}
\subsubsection[{ntoh\-\_\-ipv4\-\_\-count\-\_\-flows}]{\setlength{\rightskip}{0pt plus 5cm}unsigned int ntoh\-\_\-ipv4\-\_\-count\-\_\-flows (
\begin{DoxyParamCaption}
\item[{{\bf pntoh\-\_\-ipv4\-\_\-session\-\_\-t}}]{session}
\end{DoxyParamCaption}
)}}\label{ipv4defrag_8c_acf5643df2e4d6a1fe0477a18fc8487ce}


Returns the total count of flows stored in the global hash table. 

\begin{DoxyReturn}{Returns}
Total count of stored flows 
\end{DoxyReturn}
\hypertarget{ipv4defrag_8c_adb63592a0e2a53aec9fae9e117a681a1}{\index{ipv4defrag.\-c@{ipv4defrag.\-c}!ntoh\-\_\-ipv4\-\_\-exit@{ntoh\-\_\-ipv4\-\_\-exit}}
\index{ntoh\-\_\-ipv4\-\_\-exit@{ntoh\-\_\-ipv4\-\_\-exit}!ipv4defrag.c@{ipv4defrag.\-c}}
\subsubsection[{ntoh\-\_\-ipv4\-\_\-exit}]{\setlength{\rightskip}{0pt plus 5cm}void ntoh\-\_\-ipv4\-\_\-exit (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{ipv4defrag_8c_adb63592a0e2a53aec9fae9e117a681a1}


Flush all I\-Pv4 sessions and release all resources. 



Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=324pt]{ipv4defrag_8c_adb63592a0e2a53aec9fae9e117a681a1_cgraph}
\end{center}
\end{figure}


\hypertarget{ipv4defrag_8c_a3520b0d7dce72f58c175205cf1689802}{\index{ipv4defrag.\-c@{ipv4defrag.\-c}!ntoh\-\_\-ipv4\-\_\-find\-\_\-flow@{ntoh\-\_\-ipv4\-\_\-find\-\_\-flow}}
\index{ntoh\-\_\-ipv4\-\_\-find\-\_\-flow@{ntoh\-\_\-ipv4\-\_\-find\-\_\-flow}!ipv4defrag.c@{ipv4defrag.\-c}}
\subsubsection[{ntoh\-\_\-ipv4\-\_\-find\-\_\-flow}]{\setlength{\rightskip}{0pt plus 5cm}{\bf pntoh\-\_\-ipv4\-\_\-flow\-\_\-t} ntoh\-\_\-ipv4\-\_\-find\-\_\-flow (
\begin{DoxyParamCaption}
\item[{{\bf pntoh\-\_\-ipv4\-\_\-session\-\_\-t}}]{session, }
\item[{{\bf pntoh\-\_\-ipv4\-\_\-tuple4\-\_\-t}}]{tuple4}
\end{DoxyParamCaption}
)}}\label{ipv4defrag_8c_a3520b0d7dce72f58c175205cf1689802}


Finds an I\-P flow. 


\begin{DoxyParams}{Parameters}
{\em tuple4} & Flow information \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Pointer to the flow on success or 0 when fails 
\end{DoxyReturn}
\hypertarget{ipv4defrag_8c_a42e5f462e83ced7f73ac615e0eb7e4ab}{\index{ipv4defrag.\-c@{ipv4defrag.\-c}!ntoh\-\_\-ipv4\-\_\-free\-\_\-flow@{ntoh\-\_\-ipv4\-\_\-free\-\_\-flow}}
\index{ntoh\-\_\-ipv4\-\_\-free\-\_\-flow@{ntoh\-\_\-ipv4\-\_\-free\-\_\-flow}!ipv4defrag.c@{ipv4defrag.\-c}}
\subsubsection[{ntoh\-\_\-ipv4\-\_\-free\-\_\-flow}]{\setlength{\rightskip}{0pt plus 5cm}void ntoh\-\_\-ipv4\-\_\-free\-\_\-flow (
\begin{DoxyParamCaption}
\item[{{\bf pntoh\-\_\-ipv4\-\_\-session\-\_\-t}}]{session, }
\item[{{\bf pntoh\-\_\-ipv4\-\_\-flow\-\_\-t} $\ast$}]{flow, }
\item[{unsigned short}]{reason}
\end{DoxyParamCaption}
)}}\label{ipv4defrag_8c_a42e5f462e83ced7f73ac615e0eb7e4ab}


Frees an I\-Pv4 flow. 


\begin{DoxyParams}{Parameters}
{\em flow} & I\-Pv4 flow to be freed \\
\hline
{\em reason} & Why has been freed the flow? \\
\hline
\end{DoxyParams}
\hypertarget{ipv4defrag_8c_a9d8470322a5accf2ad4bed6edf9d79c3}{\index{ipv4defrag.\-c@{ipv4defrag.\-c}!ntoh\-\_\-ipv4\-\_\-free\-\_\-session@{ntoh\-\_\-ipv4\-\_\-free\-\_\-session}}
\index{ntoh\-\_\-ipv4\-\_\-free\-\_\-session@{ntoh\-\_\-ipv4\-\_\-free\-\_\-session}!ipv4defrag.c@{ipv4defrag.\-c}}
\subsubsection[{ntoh\-\_\-ipv4\-\_\-free\-\_\-session}]{\setlength{\rightskip}{0pt plus 5cm}void ntoh\-\_\-ipv4\-\_\-free\-\_\-session (
\begin{DoxyParamCaption}
\item[{{\bf pntoh\-\_\-ipv4\-\_\-session\-\_\-t}}]{session}
\end{DoxyParamCaption}
)}}\label{ipv4defrag_8c_a9d8470322a5accf2ad4bed6edf9d79c3}


Releases all resources used by an I\-Pv4 session. 


\begin{DoxyParams}{Parameters}
{\em session} & Session to be released \\
\hline
\end{DoxyParams}
\hypertarget{ipv4defrag_8c_a01f1e9c4a39e170cfa4ec308a31faffb}{\index{ipv4defrag.\-c@{ipv4defrag.\-c}!ntoh\-\_\-ipv4\-\_\-get\-\_\-size@{ntoh\-\_\-ipv4\-\_\-get\-\_\-size}}
\index{ntoh\-\_\-ipv4\-\_\-get\-\_\-size@{ntoh\-\_\-ipv4\-\_\-get\-\_\-size}!ipv4defrag.c@{ipv4defrag.\-c}}
\subsubsection[{ntoh\-\_\-ipv4\-\_\-get\-\_\-size}]{\setlength{\rightskip}{0pt plus 5cm}unsigned int ntoh\-\_\-ipv4\-\_\-get\-\_\-size (
\begin{DoxyParamCaption}
\item[{{\bf pntoh\-\_\-ipv4\-\_\-session\-\_\-t}}]{session}
\end{DoxyParamCaption}
)}}\label{ipv4defrag_8c_a01f1e9c4a39e170cfa4ec308a31faffb}


A\-P\-I to get the size of the flows table (max allowed flows) 

Gets the size of the flows table (max allowed flows) \hypertarget{ipv4defrag_8c_a39f759aeaf8f8996bba28ed367bdb221}{\index{ipv4defrag.\-c@{ipv4defrag.\-c}!ntoh\-\_\-ipv4\-\_\-get\-\_\-tuple4@{ntoh\-\_\-ipv4\-\_\-get\-\_\-tuple4}}
\index{ntoh\-\_\-ipv4\-\_\-get\-\_\-tuple4@{ntoh\-\_\-ipv4\-\_\-get\-\_\-tuple4}!ipv4defrag.c@{ipv4defrag.\-c}}
\subsubsection[{ntoh\-\_\-ipv4\-\_\-get\-\_\-tuple4}]{\setlength{\rightskip}{0pt plus 5cm}unsigned int ntoh\-\_\-ipv4\-\_\-get\-\_\-tuple4 (
\begin{DoxyParamCaption}
\item[{struct ip $\ast$}]{ip, }
\item[{{\bf pntoh\-\_\-ipv4\-\_\-tuple4\-\_\-t}}]{tuple}
\end{DoxyParamCaption}
)}}\label{ipv4defrag_8c_a39f759aeaf8f8996bba28ed367bdb221}


A\-P\-I to get a tuple4. 

Gets the tuple4 of a I\-Pv4 flow. \hypertarget{ipv4defrag_8c_a8fd4011f06ea8b38964d324be07cf35e}{\index{ipv4defrag.\-c@{ipv4defrag.\-c}!ntoh\-\_\-ipv4\-\_\-init@{ntoh\-\_\-ipv4\-\_\-init}}
\index{ntoh\-\_\-ipv4\-\_\-init@{ntoh\-\_\-ipv4\-\_\-init}!ipv4defrag.c@{ipv4defrag.\-c}}
\subsubsection[{ntoh\-\_\-ipv4\-\_\-init}]{\setlength{\rightskip}{0pt plus 5cm}void ntoh\-\_\-ipv4\-\_\-init (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{ipv4defrag_8c_a8fd4011f06ea8b38964d324be07cf35e}


Initializes the I\-Pv4 defragmentation. 



Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=318pt]{ipv4defrag_8c_a8fd4011f06ea8b38964d324be07cf35e_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=328pt]{ipv4defrag_8c_a8fd4011f06ea8b38964d324be07cf35e_icgraph}
\end{center}
\end{figure}


\hypertarget{ipv4defrag_8c_a6b71240da1885ddbd1cff5927f2434c0}{\index{ipv4defrag.\-c@{ipv4defrag.\-c}!ntoh\-\_\-ipv4\-\_\-new\-\_\-flow@{ntoh\-\_\-ipv4\-\_\-new\-\_\-flow}}
\index{ntoh\-\_\-ipv4\-\_\-new\-\_\-flow@{ntoh\-\_\-ipv4\-\_\-new\-\_\-flow}!ipv4defrag.c@{ipv4defrag.\-c}}
\subsubsection[{ntoh\-\_\-ipv4\-\_\-new\-\_\-flow}]{\setlength{\rightskip}{0pt plus 5cm}{\bf pntoh\-\_\-ipv4\-\_\-flow\-\_\-t} ntoh\-\_\-ipv4\-\_\-new\-\_\-flow (
\begin{DoxyParamCaption}
\item[{{\bf pntoh\-\_\-ipv4\-\_\-session\-\_\-t}}]{session, }
\item[{{\bf pntoh\-\_\-ipv4\-\_\-tuple4\-\_\-t}}]{tuple4, }
\item[{{\bf pipv4\-\_\-dfcallback\-\_\-t}}]{function, }
\item[{void $\ast$}]{udata, }
\item[{unsigned int $\ast$}]{error}
\end{DoxyParamCaption}
)}}\label{ipv4defrag_8c_a6b71240da1885ddbd1cff5927f2434c0}


Adds a new I\-Pv4 flow. 


\begin{DoxyParams}{Parameters}
{\em tuple4} & Flow information \\
\hline
{\em function} & User defined function to receive defragmented datagrams \\
\hline
{\em count\-\_\-max} & Max. fragments allowed \\
\hline
{\em udata} & User defined data associated with this flow \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A pointer to the new created flow 
\end{DoxyReturn}
\hypertarget{ipv4defrag_8c_a747aa58cdf0daac73c2ea82aa336e8ce}{\index{ipv4defrag.\-c@{ipv4defrag.\-c}!ntoh\-\_\-ipv4\-\_\-new\-\_\-session@{ntoh\-\_\-ipv4\-\_\-new\-\_\-session}}
\index{ntoh\-\_\-ipv4\-\_\-new\-\_\-session@{ntoh\-\_\-ipv4\-\_\-new\-\_\-session}!ipv4defrag.c@{ipv4defrag.\-c}}
\subsubsection[{ntoh\-\_\-ipv4\-\_\-new\-\_\-session}]{\setlength{\rightskip}{0pt plus 5cm}{\bf pntoh\-\_\-ipv4\-\_\-session\-\_\-t} ntoh\-\_\-ipv4\-\_\-new\-\_\-session (
\begin{DoxyParamCaption}
\item[{unsigned int}]{max\-\_\-flows, }
\item[{unsigned long}]{max\-\_\-mem, }
\item[{unsigned int $\ast$}]{error}
\end{DoxyParamCaption}
)}}\label{ipv4defrag_8c_a747aa58cdf0daac73c2ea82aa336e8ce}


Creates a new session with independent parameters to reassemble T\-C\-P segments. 


\begin{DoxyParams}{Parameters}
{\em max\-\_\-flows} & Max number of allowed flows in this session \\
\hline
{\em max\-\_\-mem} & Max. amount of memory used by the session \\
\hline
{\em error} & Returned error code \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A pointer to the new session or 0 when it fails 
\end{DoxyReturn}


Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{ipv4defrag_8c_a747aa58cdf0daac73c2ea82aa336e8ce_cgraph}
\end{center}
\end{figure}




\subsection{Variable Documentation}
\hypertarget{ipv4defrag_8c_a07228fb710b36433a50ad7e7a9a30cc9}{\index{ipv4defrag.\-c@{ipv4defrag.\-c}!init@{init}}
\index{init@{init}!ipv4defrag.c@{ipv4defrag.\-c}}
\subsubsection[{init}]{\setlength{\rightskip}{0pt plus 5cm}unsigned short init}}\label{ipv4defrag_8c_a07228fb710b36433a50ad7e7a9a30cc9}
\hypertarget{ipv4defrag_8c_aad15823e4f2835531e6a02321cd53f7e}{\index{ipv4defrag.\-c@{ipv4defrag.\-c}!lock@{lock}}
\index{lock@{lock}!ipv4defrag.c@{ipv4defrag.\-c}}
\subsubsection[{lock}]{\setlength{\rightskip}{0pt plus 5cm}{\bf ntoh\-\_\-lock\-\_\-t} lock}}\label{ipv4defrag_8c_aad15823e4f2835531e6a02321cd53f7e}
\hypertarget{ipv4defrag_8c_acb4c013192b761c64ecfc8ea6d810ca8}{\index{ipv4defrag.\-c@{ipv4defrag.\-c}!sessions\-\_\-list@{sessions\-\_\-list}}
\index{sessions\-\_\-list@{sessions\-\_\-list}!ipv4defrag.c@{ipv4defrag.\-c}}
\subsubsection[{sessions\-\_\-list}]{\setlength{\rightskip}{0pt plus 5cm}{\bf pntoh\-\_\-ipv4\-\_\-session\-\_\-t} sessions\-\_\-list}}\label{ipv4defrag_8c_acb4c013192b761c64ecfc8ea6d810ca8}
