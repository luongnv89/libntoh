\hypertarget{ipv6defrag_8h}{\section{inc/ipv6defrag.h File Reference}
\label{ipv6defrag_8h}\index{inc/ipv6defrag.\-h@{inc/ipv6defrag.\-h}}
}
{\ttfamily \#include $<$sys/time.\-h$>$}\\*
{\ttfamily \#include $<$netinet/in.\-h$>$}\\*
{\ttfamily \#include $<$netinet/ip6.\-h$>$}\\*
Include dependency graph for ipv6defrag.\-h\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=330pt]{ipv6defrag_8h__incl}
\end{center}
\end{figure}
This graph shows which files directly or indirectly include this file\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{ipv6defrag_8h__dep__incl}
\end{center}
\end{figure}
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structntoh__ipv6__tuple4__t}{ntoh\-\_\-ipv6\-\_\-tuple4\-\_\-t}
\begin{DoxyCompactList}\small\item\em Struct to generate the flow key. \end{DoxyCompactList}\item 
struct \hyperlink{struct__ipv6__fragment__}{\-\_\-ipv6\-\_\-fragment\-\_\-}
\begin{DoxyCompactList}\small\item\em Struct to store the information of each fragment. \end{DoxyCompactList}\item 
struct \hyperlink{structntoh__ipv6__flow__t}{ntoh\-\_\-ipv6\-\_\-flow\-\_\-t}
\begin{DoxyCompactList}\small\item\em Struct to store the information of each I\-Pv6 flow. \end{DoxyCompactList}\item 
struct \hyperlink{struct__ipv6__session__}{\-\_\-ipv6\-\_\-session\-\_\-}
\begin{DoxyCompactList}\small\item\em Structure to store global parameters. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{ipv6defrag_8h_a73bb54cc39ee44bd9d2c0ef9ffbf0195}{N\-T\-O\-H\-\_\-\-I\-P\-V6\-\_\-\-I\-S\-\_\-\-F\-R\-A\-G\-M\-E\-N\-T}(val)
\item 
\#define \hyperlink{ipv6defrag_8h_abf23031a87c2a822008b9e92548d43fa}{M\-I\-N\-\_\-\-I\-P\-V6\-\_\-\-F\-R\-A\-G\-M\-E\-N\-T\-\_\-\-L\-E\-N\-G\-T\-H}~1280
\begin{DoxyCompactList}\small\item\em min. P\-M\-T\-U \end{DoxyCompactList}\item 
\#define \hyperlink{ipv6defrag_8h_a7e14c34845e159188b74068ca63f18c7}{M\-A\-X\-\_\-\-I\-P\-V6\-\_\-\-D\-A\-T\-A\-G\-R\-A\-M\-\_\-\-L\-E\-N\-G\-T\-H}~4294967295\-U\-L
\begin{DoxyCompactList}\small\item\em max. I\-Pv6 datagram fragment length \end{DoxyCompactList}\item 
\#define \hyperlink{ipv6defrag_8h_a6fcd5544e7b1a2753495f39185a22f73}{D\-E\-F\-A\-U\-L\-T\-\_\-\-I\-P\-V6\-\_\-\-F\-R\-A\-G\-M\-E\-N\-T\-\_\-\-T\-I\-M\-E\-O\-U\-T}~15
\begin{DoxyCompactList}\small\item\em I\-Pv6 fragment timeout. \end{DoxyCompactList}\item 
\#define \hyperlink{ipv6defrag_8h_a6d1c5caff3fa3909a523c80d786fcc8b}{D\-E\-F\-A\-U\-L\-T\-\_\-\-I\-P\-V6\-\_\-\-M\-A\-X\-\_\-\-F\-L\-O\-W\-S}~1024
\begin{DoxyCompactList}\small\item\em max. I\-Pv6 allowed flows \end{DoxyCompactList}\item 
\#define \hyperlink{ipv6defrag_8h_a660d344312294014a0a0926a100d27fd}{D\-E\-F\-A\-U\-L\-T\-\_\-\-I\-P\-V6\-\_\-\-M\-A\-X\-\_\-\-F\-R\-A\-G\-M\-E\-N\-T\-S}~((12$\ast$1024$\ast$1024) / sizeof(\hyperlink{ipv6defrag_8h_a63f5f8249efd7bbfea5355ef209be6c4}{ntoh\-\_\-ipv6\-\_\-fragment\-\_\-t}))
\begin{DoxyCompactList}\small\item\em max. I\-Pv6 allowed fragments \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef struct \hyperlink{structntoh__ipv6__tuple4__t}{ntoh\-\_\-ipv6\-\_\-tuple4\-\_\-t} $\ast$ \hyperlink{ipv6defrag_8h_a4db210ee141c7407f453639a3ed3b832}{pntoh\-\_\-ipv6\-\_\-tuple4\-\_\-t}
\item 
typedef unsigned int \hyperlink{ipv6defrag_8h_a078ba881dae0588c609a3556dc5909ca}{ntoh\-\_\-ipv6\-\_\-key\-\_\-t}
\item 
typedef struct \hyperlink{struct__ipv6__fragment__}{\-\_\-ipv6\-\_\-fragment\-\_\-} \hyperlink{ipv6defrag_8h_a63f5f8249efd7bbfea5355ef209be6c4}{ntoh\-\_\-ipv6\-\_\-fragment\-\_\-t}
\begin{DoxyCompactList}\small\item\em Struct to store the information of each fragment. \end{DoxyCompactList}\item 
typedef struct \hyperlink{struct__ipv6__fragment__}{\-\_\-ipv6\-\_\-fragment\-\_\-} $\ast$ \hyperlink{ipv6defrag_8h_ae909c7bd6d9a37597f561a92ab1ba2a7}{pntoh\-\_\-ipv6\-\_\-fragment\-\_\-t}
\item 
typedef struct \hyperlink{structntoh__ipv6__flow__t}{ntoh\-\_\-ipv6\-\_\-flow\-\_\-t} $\ast$ \hyperlink{ipv6defrag_8h_a22d5b5c2361647104c63fcc5d78935fd}{pntoh\-\_\-ipv6\-\_\-flow\-\_\-t}
\item 
typedef \hyperlink{structhtable__t}{htable\-\_\-t} \hyperlink{ipv6defrag_8h_a380bcb032a4b316804354e6d69cdde8e}{ipv6\-\_\-flows\-\_\-table\-\_\-t}
\item 
typedef \hyperlink{common_8h_afb6650ea3c7d2a821a4f503991dc6e6c}{phtable\-\_\-t} \hyperlink{ipv6defrag_8h_aa864213ee9a224d009da94990b5ba1d7}{pipv6\-\_\-flows\-\_\-table\-\_\-t}
\item 
typedef struct \hyperlink{struct__ipv6__session__}{\-\_\-ipv6\-\_\-session\-\_\-} \hyperlink{ipv6defrag_8h_aef907d8a20d8278a788173a3941f457e}{ntoh\-\_\-ipv6\-\_\-session\-\_\-t}
\begin{DoxyCompactList}\small\item\em Structure to store global parameters. \end{DoxyCompactList}\item 
typedef struct \hyperlink{struct__ipv6__session__}{\-\_\-ipv6\-\_\-session\-\_\-} $\ast$ \hyperlink{ipv6defrag_8h_a40faea7fd542cf73f764a1981ffd31d0}{pntoh\-\_\-ipv6\-\_\-session\-\_\-t}
\item 
typedef void($\ast$ \hyperlink{ipv6defrag_8h_a940f6670b906dd8ea05d56a98586f9f0}{pipv6\-\_\-dfcallback\-\_\-t} )(\hyperlink{ipv6defrag_8h_a22d5b5c2361647104c63fcc5d78935fd}{pntoh\-\_\-ipv6\-\_\-flow\-\_\-t}, \hyperlink{ipv6defrag_8h_a4db210ee141c7407f453639a3ed3b832}{pntoh\-\_\-ipv6\-\_\-tuple4\-\_\-t}, unsigned char $\ast$, size\-\_\-t, unsigned short)
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{ipv6defrag_8h_ab0a121ef041811b426b17ee60bd33ebd}{ntoh\-\_\-ipv6\-\_\-init} (void)
\begin{DoxyCompactList}\small\item\em Initializes the I\-Pv6 defragmentation. \end{DoxyCompactList}\item 
void \hyperlink{ipv6defrag_8h_a60e8d532c6a1b8fddb69955737fc9daa}{ntoh\-\_\-ipv6\-\_\-exit} (void)
\begin{DoxyCompactList}\small\item\em Flush all I\-Pv6 sessions and release all resources. \end{DoxyCompactList}\item 
void \hyperlink{ipv6defrag_8h_a7e5d65bc976117147fc079ac6d18fc76}{ntoh\-\_\-ipv6\-\_\-free\-\_\-session} (\hyperlink{ipv6defrag_8h_a40faea7fd542cf73f764a1981ffd31d0}{pntoh\-\_\-ipv6\-\_\-session\-\_\-t} session)
\begin{DoxyCompactList}\small\item\em Releases all resources used by an I\-Pv6 session. \end{DoxyCompactList}\item 
\hyperlink{ipv6defrag_8h_a40faea7fd542cf73f764a1981ffd31d0}{pntoh\-\_\-ipv6\-\_\-session\-\_\-t} \hyperlink{ipv6defrag_8h_a2cddaf8d48fbba5e5702b3fac5f02ece}{ntoh\-\_\-ipv6\-\_\-new\-\_\-session} (unsigned int max\-\_\-flows, unsigned long max\-\_\-mem, unsigned int $\ast$error)
\begin{DoxyCompactList}\small\item\em Creates a new session with independent parameters to reassemble T\-C\-P segments. \end{DoxyCompactList}\item 
\hyperlink{ipv6defrag_8h_a22d5b5c2361647104c63fcc5d78935fd}{pntoh\-\_\-ipv6\-\_\-flow\-\_\-t} \hyperlink{ipv6defrag_8h_a4d95b843e260136f9974163322c4af78}{ntoh\-\_\-ipv6\-\_\-find\-\_\-flow} (\hyperlink{ipv6defrag_8h_a40faea7fd542cf73f764a1981ffd31d0}{pntoh\-\_\-ipv6\-\_\-session\-\_\-t} session, \hyperlink{ipv6defrag_8h_a4db210ee141c7407f453639a3ed3b832}{pntoh\-\_\-ipv6\-\_\-tuple4\-\_\-t} tuple4)
\begin{DoxyCompactList}\small\item\em Finds an I\-P flow. \end{DoxyCompactList}\item 
\hyperlink{ipv6defrag_8h_a22d5b5c2361647104c63fcc5d78935fd}{pntoh\-\_\-ipv6\-\_\-flow\-\_\-t} \hyperlink{ipv6defrag_8h_a5dff4b25bcf2a68eb347356f57004027}{ntoh\-\_\-ipv6\-\_\-new\-\_\-flow} (\hyperlink{ipv6defrag_8h_a40faea7fd542cf73f764a1981ffd31d0}{pntoh\-\_\-ipv6\-\_\-session\-\_\-t} session, \hyperlink{ipv6defrag_8h_a4db210ee141c7407f453639a3ed3b832}{pntoh\-\_\-ipv6\-\_\-tuple4\-\_\-t} tuple4, \hyperlink{ipv6defrag_8h_a940f6670b906dd8ea05d56a98586f9f0}{pipv6\-\_\-dfcallback\-\_\-t} function, void $\ast$udata, unsigned int $\ast$error)
\begin{DoxyCompactList}\small\item\em Adds a new I\-Pv6 flow. \end{DoxyCompactList}\item 
void \hyperlink{ipv6defrag_8h_a3a70e1eaf88ca00b5aba9d5b540ebb0f}{ntoh\-\_\-ipv6\-\_\-free\-\_\-flow} (\hyperlink{ipv6defrag_8h_a40faea7fd542cf73f764a1981ffd31d0}{pntoh\-\_\-ipv6\-\_\-session\-\_\-t} session, \hyperlink{ipv6defrag_8h_a22d5b5c2361647104c63fcc5d78935fd}{pntoh\-\_\-ipv6\-\_\-flow\-\_\-t} $\ast$flow, unsigned short reason)
\begin{DoxyCompactList}\small\item\em Frees an I\-Pv6 flow. \end{DoxyCompactList}\item 
int \hyperlink{ipv6defrag_8h_a65e489a8ddc251e464e8b5d643fffe39}{ntoh\-\_\-ipv6\-\_\-add\-\_\-fragment} (\hyperlink{ipv6defrag_8h_a40faea7fd542cf73f764a1981ffd31d0}{pntoh\-\_\-ipv6\-\_\-session\-\_\-t} session, \hyperlink{ipv6defrag_8h_a22d5b5c2361647104c63fcc5d78935fd}{pntoh\-\_\-ipv6\-\_\-flow\-\_\-t} flow, struct ip6\-\_\-hdr $\ast$iphdr, size\-\_\-t len)
\begin{DoxyCompactList}\small\item\em Adds a new I\-Pv6 fragment to a given flow. \end{DoxyCompactList}\item 
unsigned int \hyperlink{ipv6defrag_8h_ac441924432a54289e0e8e3d0065af034}{ntoh\-\_\-ipv6\-\_\-count\-\_\-flows} (\hyperlink{ipv6defrag_8h_a40faea7fd542cf73f764a1981ffd31d0}{pntoh\-\_\-ipv6\-\_\-session\-\_\-t} session)
\begin{DoxyCompactList}\small\item\em Returns the total count of flows stored in the global hash table. \end{DoxyCompactList}\item 
unsigned int \hyperlink{ipv6defrag_8h_ad4e3ffd4c74ea4ce8df171708c4a8a66}{ntoh\-\_\-ipv6\-\_\-get\-\_\-size} (\hyperlink{ipv6defrag_8h_a40faea7fd542cf73f764a1981ffd31d0}{pntoh\-\_\-ipv6\-\_\-session\-\_\-t} session)
\begin{DoxyCompactList}\small\item\em Gets the size of the flows table (max allowed flows) \end{DoxyCompactList}\item 
unsigned int \hyperlink{ipv6defrag_8h_a2f57f546b934e37305aff7e968251b5d}{ntoh\-\_\-ipv6\-\_\-get\-\_\-tuple4} (struct ip6\-\_\-hdr $\ast$ip, \hyperlink{ipv6defrag_8h_a4db210ee141c7407f453639a3ed3b832}{pntoh\-\_\-ipv6\-\_\-tuple4\-\_\-t} tuple)
\begin{DoxyCompactList}\small\item\em Gets the tuple4 of a I\-Pv6 flow. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\hypertarget{ipv6defrag_8h_a6fcd5544e7b1a2753495f39185a22f73}{\index{ipv6defrag.\-h@{ipv6defrag.\-h}!D\-E\-F\-A\-U\-L\-T\-\_\-\-I\-P\-V6\-\_\-\-F\-R\-A\-G\-M\-E\-N\-T\-\_\-\-T\-I\-M\-E\-O\-U\-T@{D\-E\-F\-A\-U\-L\-T\-\_\-\-I\-P\-V6\-\_\-\-F\-R\-A\-G\-M\-E\-N\-T\-\_\-\-T\-I\-M\-E\-O\-U\-T}}
\index{D\-E\-F\-A\-U\-L\-T\-\_\-\-I\-P\-V6\-\_\-\-F\-R\-A\-G\-M\-E\-N\-T\-\_\-\-T\-I\-M\-E\-O\-U\-T@{D\-E\-F\-A\-U\-L\-T\-\_\-\-I\-P\-V6\-\_\-\-F\-R\-A\-G\-M\-E\-N\-T\-\_\-\-T\-I\-M\-E\-O\-U\-T}!ipv6defrag.h@{ipv6defrag.\-h}}
\subsubsection[{D\-E\-F\-A\-U\-L\-T\-\_\-\-I\-P\-V6\-\_\-\-F\-R\-A\-G\-M\-E\-N\-T\-\_\-\-T\-I\-M\-E\-O\-U\-T}]{\setlength{\rightskip}{0pt plus 5cm}\#define D\-E\-F\-A\-U\-L\-T\-\_\-\-I\-P\-V6\-\_\-\-F\-R\-A\-G\-M\-E\-N\-T\-\_\-\-T\-I\-M\-E\-O\-U\-T~15}}\label{ipv6defrag_8h_a6fcd5544e7b1a2753495f39185a22f73}


I\-Pv6 fragment timeout. 

\hypertarget{ipv6defrag_8h_a6d1c5caff3fa3909a523c80d786fcc8b}{\index{ipv6defrag.\-h@{ipv6defrag.\-h}!D\-E\-F\-A\-U\-L\-T\-\_\-\-I\-P\-V6\-\_\-\-M\-A\-X\-\_\-\-F\-L\-O\-W\-S@{D\-E\-F\-A\-U\-L\-T\-\_\-\-I\-P\-V6\-\_\-\-M\-A\-X\-\_\-\-F\-L\-O\-W\-S}}
\index{D\-E\-F\-A\-U\-L\-T\-\_\-\-I\-P\-V6\-\_\-\-M\-A\-X\-\_\-\-F\-L\-O\-W\-S@{D\-E\-F\-A\-U\-L\-T\-\_\-\-I\-P\-V6\-\_\-\-M\-A\-X\-\_\-\-F\-L\-O\-W\-S}!ipv6defrag.h@{ipv6defrag.\-h}}
\subsubsection[{D\-E\-F\-A\-U\-L\-T\-\_\-\-I\-P\-V6\-\_\-\-M\-A\-X\-\_\-\-F\-L\-O\-W\-S}]{\setlength{\rightskip}{0pt plus 5cm}\#define D\-E\-F\-A\-U\-L\-T\-\_\-\-I\-P\-V6\-\_\-\-M\-A\-X\-\_\-\-F\-L\-O\-W\-S~1024}}\label{ipv6defrag_8h_a6d1c5caff3fa3909a523c80d786fcc8b}


max. I\-Pv6 allowed flows 

\hypertarget{ipv6defrag_8h_a660d344312294014a0a0926a100d27fd}{\index{ipv6defrag.\-h@{ipv6defrag.\-h}!D\-E\-F\-A\-U\-L\-T\-\_\-\-I\-P\-V6\-\_\-\-M\-A\-X\-\_\-\-F\-R\-A\-G\-M\-E\-N\-T\-S@{D\-E\-F\-A\-U\-L\-T\-\_\-\-I\-P\-V6\-\_\-\-M\-A\-X\-\_\-\-F\-R\-A\-G\-M\-E\-N\-T\-S}}
\index{D\-E\-F\-A\-U\-L\-T\-\_\-\-I\-P\-V6\-\_\-\-M\-A\-X\-\_\-\-F\-R\-A\-G\-M\-E\-N\-T\-S@{D\-E\-F\-A\-U\-L\-T\-\_\-\-I\-P\-V6\-\_\-\-M\-A\-X\-\_\-\-F\-R\-A\-G\-M\-E\-N\-T\-S}!ipv6defrag.h@{ipv6defrag.\-h}}
\subsubsection[{D\-E\-F\-A\-U\-L\-T\-\_\-\-I\-P\-V6\-\_\-\-M\-A\-X\-\_\-\-F\-R\-A\-G\-M\-E\-N\-T\-S}]{\setlength{\rightskip}{0pt plus 5cm}\#define D\-E\-F\-A\-U\-L\-T\-\_\-\-I\-P\-V6\-\_\-\-M\-A\-X\-\_\-\-F\-R\-A\-G\-M\-E\-N\-T\-S~((12$\ast$1024$\ast$1024) / sizeof({\bf ntoh\-\_\-ipv6\-\_\-fragment\-\_\-t}))}}\label{ipv6defrag_8h_a660d344312294014a0a0926a100d27fd}


max. I\-Pv6 allowed fragments 

\hypertarget{ipv6defrag_8h_a7e14c34845e159188b74068ca63f18c7}{\index{ipv6defrag.\-h@{ipv6defrag.\-h}!M\-A\-X\-\_\-\-I\-P\-V6\-\_\-\-D\-A\-T\-A\-G\-R\-A\-M\-\_\-\-L\-E\-N\-G\-T\-H@{M\-A\-X\-\_\-\-I\-P\-V6\-\_\-\-D\-A\-T\-A\-G\-R\-A\-M\-\_\-\-L\-E\-N\-G\-T\-H}}
\index{M\-A\-X\-\_\-\-I\-P\-V6\-\_\-\-D\-A\-T\-A\-G\-R\-A\-M\-\_\-\-L\-E\-N\-G\-T\-H@{M\-A\-X\-\_\-\-I\-P\-V6\-\_\-\-D\-A\-T\-A\-G\-R\-A\-M\-\_\-\-L\-E\-N\-G\-T\-H}!ipv6defrag.h@{ipv6defrag.\-h}}
\subsubsection[{M\-A\-X\-\_\-\-I\-P\-V6\-\_\-\-D\-A\-T\-A\-G\-R\-A\-M\-\_\-\-L\-E\-N\-G\-T\-H}]{\setlength{\rightskip}{0pt plus 5cm}\#define M\-A\-X\-\_\-\-I\-P\-V6\-\_\-\-D\-A\-T\-A\-G\-R\-A\-M\-\_\-\-L\-E\-N\-G\-T\-H~4294967295\-U\-L}}\label{ipv6defrag_8h_a7e14c34845e159188b74068ca63f18c7}


max. I\-Pv6 datagram fragment length 

\hypertarget{ipv6defrag_8h_abf23031a87c2a822008b9e92548d43fa}{\index{ipv6defrag.\-h@{ipv6defrag.\-h}!M\-I\-N\-\_\-\-I\-P\-V6\-\_\-\-F\-R\-A\-G\-M\-E\-N\-T\-\_\-\-L\-E\-N\-G\-T\-H@{M\-I\-N\-\_\-\-I\-P\-V6\-\_\-\-F\-R\-A\-G\-M\-E\-N\-T\-\_\-\-L\-E\-N\-G\-T\-H}}
\index{M\-I\-N\-\_\-\-I\-P\-V6\-\_\-\-F\-R\-A\-G\-M\-E\-N\-T\-\_\-\-L\-E\-N\-G\-T\-H@{M\-I\-N\-\_\-\-I\-P\-V6\-\_\-\-F\-R\-A\-G\-M\-E\-N\-T\-\_\-\-L\-E\-N\-G\-T\-H}!ipv6defrag.h@{ipv6defrag.\-h}}
\subsubsection[{M\-I\-N\-\_\-\-I\-P\-V6\-\_\-\-F\-R\-A\-G\-M\-E\-N\-T\-\_\-\-L\-E\-N\-G\-T\-H}]{\setlength{\rightskip}{0pt plus 5cm}\#define M\-I\-N\-\_\-\-I\-P\-V6\-\_\-\-F\-R\-A\-G\-M\-E\-N\-T\-\_\-\-L\-E\-N\-G\-T\-H~1280}}\label{ipv6defrag_8h_abf23031a87c2a822008b9e92548d43fa}


min. P\-M\-T\-U 

\hypertarget{ipv6defrag_8h_a73bb54cc39ee44bd9d2c0ef9ffbf0195}{\index{ipv6defrag.\-h@{ipv6defrag.\-h}!N\-T\-O\-H\-\_\-\-I\-P\-V6\-\_\-\-I\-S\-\_\-\-F\-R\-A\-G\-M\-E\-N\-T@{N\-T\-O\-H\-\_\-\-I\-P\-V6\-\_\-\-I\-S\-\_\-\-F\-R\-A\-G\-M\-E\-N\-T}}
\index{N\-T\-O\-H\-\_\-\-I\-P\-V6\-\_\-\-I\-S\-\_\-\-F\-R\-A\-G\-M\-E\-N\-T@{N\-T\-O\-H\-\_\-\-I\-P\-V6\-\_\-\-I\-S\-\_\-\-F\-R\-A\-G\-M\-E\-N\-T}!ipv6defrag.h@{ipv6defrag.\-h}}
\subsubsection[{N\-T\-O\-H\-\_\-\-I\-P\-V6\-\_\-\-I\-S\-\_\-\-F\-R\-A\-G\-M\-E\-N\-T}]{\setlength{\rightskip}{0pt plus 5cm}\#define N\-T\-O\-H\-\_\-\-I\-P\-V6\-\_\-\-I\-S\-\_\-\-F\-R\-A\-G\-M\-E\-N\-T(
\begin{DoxyParamCaption}
\item[{}]{val}
\end{DoxyParamCaption}
)}}\label{ipv6defrag_8h_a73bb54cc39ee44bd9d2c0ef9ffbf0195}
{\bfseries Value\-:}
\begin{DoxyCode}
(((\textcolor{keyword}{struct }ip6\_hdr*)val)->ip6\_nxt==IPPROTO\_FRAGMENT && \(\backslash\)
                                     ( \(\backslash\)
                                      (ntohs(((\textcolor{keyword}{struct} ip6\_frag *)((\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}*)val+\textcolor{keyword}{sizeof}(\textcolor{keyword}{struct} ip6\_hdr
      )))->ip6f\_offlg) & IP6F\_OFF\_MASK)>0 || \(\backslash\)
                                      (ntohs(((\textcolor{keyword}{struct} ip6\_frag *)((\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}*)val+\textcolor{keyword}{sizeof}(\textcolor{keyword}{struct} ip6\_hdr
      )))->ip6f\_offlg & IP6F\_MORE\_FRAG)>0) \(\backslash\)
                                      ))
\end{DoxyCode}


\subsection{Typedef Documentation}
\hypertarget{ipv6defrag_8h_a380bcb032a4b316804354e6d69cdde8e}{\index{ipv6defrag.\-h@{ipv6defrag.\-h}!ipv6\-\_\-flows\-\_\-table\-\_\-t@{ipv6\-\_\-flows\-\_\-table\-\_\-t}}
\index{ipv6\-\_\-flows\-\_\-table\-\_\-t@{ipv6\-\_\-flows\-\_\-table\-\_\-t}!ipv6defrag.h@{ipv6defrag.\-h}}
\subsubsection[{ipv6\-\_\-flows\-\_\-table\-\_\-t}]{\setlength{\rightskip}{0pt plus 5cm}typedef {\bf htable\-\_\-t} {\bf ipv6\-\_\-flows\-\_\-table\-\_\-t}}}\label{ipv6defrag_8h_a380bcb032a4b316804354e6d69cdde8e}
\hypertarget{ipv6defrag_8h_a63f5f8249efd7bbfea5355ef209be6c4}{\index{ipv6defrag.\-h@{ipv6defrag.\-h}!ntoh\-\_\-ipv6\-\_\-fragment\-\_\-t@{ntoh\-\_\-ipv6\-\_\-fragment\-\_\-t}}
\index{ntoh\-\_\-ipv6\-\_\-fragment\-\_\-t@{ntoh\-\_\-ipv6\-\_\-fragment\-\_\-t}!ipv6defrag.h@{ipv6defrag.\-h}}
\subsubsection[{ntoh\-\_\-ipv6\-\_\-fragment\-\_\-t}]{\setlength{\rightskip}{0pt plus 5cm}typedef struct {\bf \-\_\-ipv6\-\_\-fragment\-\_\-}  {\bf ntoh\-\_\-ipv6\-\_\-fragment\-\_\-t}}}\label{ipv6defrag_8h_a63f5f8249efd7bbfea5355ef209be6c4}


Struct to store the information of each fragment. 

\hypertarget{ipv6defrag_8h_a078ba881dae0588c609a3556dc5909ca}{\index{ipv6defrag.\-h@{ipv6defrag.\-h}!ntoh\-\_\-ipv6\-\_\-key\-\_\-t@{ntoh\-\_\-ipv6\-\_\-key\-\_\-t}}
\index{ntoh\-\_\-ipv6\-\_\-key\-\_\-t@{ntoh\-\_\-ipv6\-\_\-key\-\_\-t}!ipv6defrag.h@{ipv6defrag.\-h}}
\subsubsection[{ntoh\-\_\-ipv6\-\_\-key\-\_\-t}]{\setlength{\rightskip}{0pt plus 5cm}typedef unsigned int {\bf ntoh\-\_\-ipv6\-\_\-key\-\_\-t}}}\label{ipv6defrag_8h_a078ba881dae0588c609a3556dc5909ca}
\hypertarget{ipv6defrag_8h_aef907d8a20d8278a788173a3941f457e}{\index{ipv6defrag.\-h@{ipv6defrag.\-h}!ntoh\-\_\-ipv6\-\_\-session\-\_\-t@{ntoh\-\_\-ipv6\-\_\-session\-\_\-t}}
\index{ntoh\-\_\-ipv6\-\_\-session\-\_\-t@{ntoh\-\_\-ipv6\-\_\-session\-\_\-t}!ipv6defrag.h@{ipv6defrag.\-h}}
\subsubsection[{ntoh\-\_\-ipv6\-\_\-session\-\_\-t}]{\setlength{\rightskip}{0pt plus 5cm}typedef struct {\bf \-\_\-ipv6\-\_\-session\-\_\-} {\bf ntoh\-\_\-ipv6\-\_\-session\-\_\-t}}}\label{ipv6defrag_8h_aef907d8a20d8278a788173a3941f457e}


Structure to store global parameters. 

\hypertarget{ipv6defrag_8h_a940f6670b906dd8ea05d56a98586f9f0}{\index{ipv6defrag.\-h@{ipv6defrag.\-h}!pipv6\-\_\-dfcallback\-\_\-t@{pipv6\-\_\-dfcallback\-\_\-t}}
\index{pipv6\-\_\-dfcallback\-\_\-t@{pipv6\-\_\-dfcallback\-\_\-t}!ipv6defrag.h@{ipv6defrag.\-h}}
\subsubsection[{pipv6\-\_\-dfcallback\-\_\-t}]{\setlength{\rightskip}{0pt plus 5cm}typedef void($\ast$ pipv6\-\_\-dfcallback\-\_\-t)({\bf pntoh\-\_\-ipv6\-\_\-flow\-\_\-t}, {\bf pntoh\-\_\-ipv6\-\_\-tuple4\-\_\-t}, unsigned char $\ast$, size\-\_\-t, unsigned short)}}\label{ipv6defrag_8h_a940f6670b906dd8ea05d56a98586f9f0}
\hypertarget{ipv6defrag_8h_aa864213ee9a224d009da94990b5ba1d7}{\index{ipv6defrag.\-h@{ipv6defrag.\-h}!pipv6\-\_\-flows\-\_\-table\-\_\-t@{pipv6\-\_\-flows\-\_\-table\-\_\-t}}
\index{pipv6\-\_\-flows\-\_\-table\-\_\-t@{pipv6\-\_\-flows\-\_\-table\-\_\-t}!ipv6defrag.h@{ipv6defrag.\-h}}
\subsubsection[{pipv6\-\_\-flows\-\_\-table\-\_\-t}]{\setlength{\rightskip}{0pt plus 5cm}typedef {\bf phtable\-\_\-t} {\bf pipv6\-\_\-flows\-\_\-table\-\_\-t}}}\label{ipv6defrag_8h_aa864213ee9a224d009da94990b5ba1d7}
\hypertarget{ipv6defrag_8h_a22d5b5c2361647104c63fcc5d78935fd}{\index{ipv6defrag.\-h@{ipv6defrag.\-h}!pntoh\-\_\-ipv6\-\_\-flow\-\_\-t@{pntoh\-\_\-ipv6\-\_\-flow\-\_\-t}}
\index{pntoh\-\_\-ipv6\-\_\-flow\-\_\-t@{pntoh\-\_\-ipv6\-\_\-flow\-\_\-t}!ipv6defrag.h@{ipv6defrag.\-h}}
\subsubsection[{pntoh\-\_\-ipv6\-\_\-flow\-\_\-t}]{\setlength{\rightskip}{0pt plus 5cm}typedef  struct {\bf ntoh\-\_\-ipv6\-\_\-flow\-\_\-t} $\ast$ {\bf pntoh\-\_\-ipv6\-\_\-flow\-\_\-t}}}\label{ipv6defrag_8h_a22d5b5c2361647104c63fcc5d78935fd}
\hypertarget{ipv6defrag_8h_ae909c7bd6d9a37597f561a92ab1ba2a7}{\index{ipv6defrag.\-h@{ipv6defrag.\-h}!pntoh\-\_\-ipv6\-\_\-fragment\-\_\-t@{pntoh\-\_\-ipv6\-\_\-fragment\-\_\-t}}
\index{pntoh\-\_\-ipv6\-\_\-fragment\-\_\-t@{pntoh\-\_\-ipv6\-\_\-fragment\-\_\-t}!ipv6defrag.h@{ipv6defrag.\-h}}
\subsubsection[{pntoh\-\_\-ipv6\-\_\-fragment\-\_\-t}]{\setlength{\rightskip}{0pt plus 5cm}typedef struct {\bf \-\_\-ipv6\-\_\-fragment\-\_\-} $\ast$ {\bf pntoh\-\_\-ipv6\-\_\-fragment\-\_\-t}}}\label{ipv6defrag_8h_ae909c7bd6d9a37597f561a92ab1ba2a7}
\hypertarget{ipv6defrag_8h_a40faea7fd542cf73f764a1981ffd31d0}{\index{ipv6defrag.\-h@{ipv6defrag.\-h}!pntoh\-\_\-ipv6\-\_\-session\-\_\-t@{pntoh\-\_\-ipv6\-\_\-session\-\_\-t}}
\index{pntoh\-\_\-ipv6\-\_\-session\-\_\-t@{pntoh\-\_\-ipv6\-\_\-session\-\_\-t}!ipv6defrag.h@{ipv6defrag.\-h}}
\subsubsection[{pntoh\-\_\-ipv6\-\_\-session\-\_\-t}]{\setlength{\rightskip}{0pt plus 5cm}typedef struct {\bf \-\_\-ipv6\-\_\-session\-\_\-} $\ast$ {\bf pntoh\-\_\-ipv6\-\_\-session\-\_\-t}}}\label{ipv6defrag_8h_a40faea7fd542cf73f764a1981ffd31d0}
\hypertarget{ipv6defrag_8h_a4db210ee141c7407f453639a3ed3b832}{\index{ipv6defrag.\-h@{ipv6defrag.\-h}!pntoh\-\_\-ipv6\-\_\-tuple4\-\_\-t@{pntoh\-\_\-ipv6\-\_\-tuple4\-\_\-t}}
\index{pntoh\-\_\-ipv6\-\_\-tuple4\-\_\-t@{pntoh\-\_\-ipv6\-\_\-tuple4\-\_\-t}!ipv6defrag.h@{ipv6defrag.\-h}}
\subsubsection[{pntoh\-\_\-ipv6\-\_\-tuple4\-\_\-t}]{\setlength{\rightskip}{0pt plus 5cm}typedef  struct {\bf ntoh\-\_\-ipv6\-\_\-tuple4\-\_\-t} $\ast$ {\bf pntoh\-\_\-ipv6\-\_\-tuple4\-\_\-t}}}\label{ipv6defrag_8h_a4db210ee141c7407f453639a3ed3b832}


\subsection{Function Documentation}
\hypertarget{ipv6defrag_8h_a65e489a8ddc251e464e8b5d643fffe39}{\index{ipv6defrag.\-h@{ipv6defrag.\-h}!ntoh\-\_\-ipv6\-\_\-add\-\_\-fragment@{ntoh\-\_\-ipv6\-\_\-add\-\_\-fragment}}
\index{ntoh\-\_\-ipv6\-\_\-add\-\_\-fragment@{ntoh\-\_\-ipv6\-\_\-add\-\_\-fragment}!ipv6defrag.h@{ipv6defrag.\-h}}
\subsubsection[{ntoh\-\_\-ipv6\-\_\-add\-\_\-fragment}]{\setlength{\rightskip}{0pt plus 5cm}int ntoh\-\_\-ipv6\-\_\-add\-\_\-fragment (
\begin{DoxyParamCaption}
\item[{{\bf pntoh\-\_\-ipv6\-\_\-session\-\_\-t}}]{session, }
\item[{{\bf pntoh\-\_\-ipv6\-\_\-flow\-\_\-t}}]{flow, }
\item[{struct ip6\-\_\-hdr $\ast$}]{iphdr, }
\item[{size\-\_\-t}]{len}
\end{DoxyParamCaption}
)}}\label{ipv6defrag_8h_a65e489a8ddc251e464e8b5d643fffe39}


Adds a new I\-Pv6 fragment to a given flow. 


\begin{DoxyParams}{Parameters}
{\em flow} & Flow where the new fragment will be added \\
\hline
{\em iphdr} & I\-Pv6 Header of the fragment \\
\hline
{\em len} & Length of the fragment (I\-Pv6 header + payload) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
N\-T\-O\-H\-\_\-\-O\-K on success, or error code when it fails 
\end{DoxyReturn}
\begin{DoxyRefDesc}{Todo}
\item[\hyperlink{todo__todo000002}{Todo}]\-: only checks the first header, should we verify them all? \end{DoxyRefDesc}
\hypertarget{ipv6defrag_8h_ac441924432a54289e0e8e3d0065af034}{\index{ipv6defrag.\-h@{ipv6defrag.\-h}!ntoh\-\_\-ipv6\-\_\-count\-\_\-flows@{ntoh\-\_\-ipv6\-\_\-count\-\_\-flows}}
\index{ntoh\-\_\-ipv6\-\_\-count\-\_\-flows@{ntoh\-\_\-ipv6\-\_\-count\-\_\-flows}!ipv6defrag.h@{ipv6defrag.\-h}}
\subsubsection[{ntoh\-\_\-ipv6\-\_\-count\-\_\-flows}]{\setlength{\rightskip}{0pt plus 5cm}unsigned int ntoh\-\_\-ipv6\-\_\-count\-\_\-flows (
\begin{DoxyParamCaption}
\item[{{\bf pntoh\-\_\-ipv6\-\_\-session\-\_\-t}}]{session}
\end{DoxyParamCaption}
)}}\label{ipv6defrag_8h_ac441924432a54289e0e8e3d0065af034}


Returns the total count of flows stored in the global hash table. 

\begin{DoxyReturn}{Returns}
Total count of stored flows 
\end{DoxyReturn}
\hypertarget{ipv6defrag_8h_a60e8d532c6a1b8fddb69955737fc9daa}{\index{ipv6defrag.\-h@{ipv6defrag.\-h}!ntoh\-\_\-ipv6\-\_\-exit@{ntoh\-\_\-ipv6\-\_\-exit}}
\index{ntoh\-\_\-ipv6\-\_\-exit@{ntoh\-\_\-ipv6\-\_\-exit}!ipv6defrag.h@{ipv6defrag.\-h}}
\subsubsection[{ntoh\-\_\-ipv6\-\_\-exit}]{\setlength{\rightskip}{0pt plus 5cm}void ntoh\-\_\-ipv6\-\_\-exit (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{ipv6defrag_8h_a60e8d532c6a1b8fddb69955737fc9daa}


Flush all I\-Pv6 sessions and release all resources. 



Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=324pt]{ipv6defrag_8h_a60e8d532c6a1b8fddb69955737fc9daa_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=166pt]{ipv6defrag_8h_a60e8d532c6a1b8fddb69955737fc9daa_icgraph}
\end{center}
\end{figure}


\hypertarget{ipv6defrag_8h_a4d95b843e260136f9974163322c4af78}{\index{ipv6defrag.\-h@{ipv6defrag.\-h}!ntoh\-\_\-ipv6\-\_\-find\-\_\-flow@{ntoh\-\_\-ipv6\-\_\-find\-\_\-flow}}
\index{ntoh\-\_\-ipv6\-\_\-find\-\_\-flow@{ntoh\-\_\-ipv6\-\_\-find\-\_\-flow}!ipv6defrag.h@{ipv6defrag.\-h}}
\subsubsection[{ntoh\-\_\-ipv6\-\_\-find\-\_\-flow}]{\setlength{\rightskip}{0pt plus 5cm}{\bf pntoh\-\_\-ipv6\-\_\-flow\-\_\-t} ntoh\-\_\-ipv6\-\_\-find\-\_\-flow (
\begin{DoxyParamCaption}
\item[{{\bf pntoh\-\_\-ipv6\-\_\-session\-\_\-t}}]{session, }
\item[{{\bf pntoh\-\_\-ipv6\-\_\-tuple4\-\_\-t}}]{tuple4}
\end{DoxyParamCaption}
)}}\label{ipv6defrag_8h_a4d95b843e260136f9974163322c4af78}


Finds an I\-P flow. 


\begin{DoxyParams}{Parameters}
{\em tuple4} & Flow information \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Pointer to the flow on success or 0 when fails 
\end{DoxyReturn}
\hypertarget{ipv6defrag_8h_a3a70e1eaf88ca00b5aba9d5b540ebb0f}{\index{ipv6defrag.\-h@{ipv6defrag.\-h}!ntoh\-\_\-ipv6\-\_\-free\-\_\-flow@{ntoh\-\_\-ipv6\-\_\-free\-\_\-flow}}
\index{ntoh\-\_\-ipv6\-\_\-free\-\_\-flow@{ntoh\-\_\-ipv6\-\_\-free\-\_\-flow}!ipv6defrag.h@{ipv6defrag.\-h}}
\subsubsection[{ntoh\-\_\-ipv6\-\_\-free\-\_\-flow}]{\setlength{\rightskip}{0pt plus 5cm}void ntoh\-\_\-ipv6\-\_\-free\-\_\-flow (
\begin{DoxyParamCaption}
\item[{{\bf pntoh\-\_\-ipv6\-\_\-session\-\_\-t}}]{session, }
\item[{{\bf pntoh\-\_\-ipv6\-\_\-flow\-\_\-t} $\ast$}]{flow, }
\item[{unsigned short}]{reason}
\end{DoxyParamCaption}
)}}\label{ipv6defrag_8h_a3a70e1eaf88ca00b5aba9d5b540ebb0f}


Frees an I\-Pv6 flow. 


\begin{DoxyParams}{Parameters}
{\em flow} & I\-Pv6 flow to be freed \\
\hline
{\em reason} & Why has been freed the flow? \\
\hline
\end{DoxyParams}
\hypertarget{ipv6defrag_8h_a7e5d65bc976117147fc079ac6d18fc76}{\index{ipv6defrag.\-h@{ipv6defrag.\-h}!ntoh\-\_\-ipv6\-\_\-free\-\_\-session@{ntoh\-\_\-ipv6\-\_\-free\-\_\-session}}
\index{ntoh\-\_\-ipv6\-\_\-free\-\_\-session@{ntoh\-\_\-ipv6\-\_\-free\-\_\-session}!ipv6defrag.h@{ipv6defrag.\-h}}
\subsubsection[{ntoh\-\_\-ipv6\-\_\-free\-\_\-session}]{\setlength{\rightskip}{0pt plus 5cm}void ntoh\-\_\-ipv6\-\_\-free\-\_\-session (
\begin{DoxyParamCaption}
\item[{{\bf pntoh\-\_\-ipv6\-\_\-session\-\_\-t}}]{session}
\end{DoxyParamCaption}
)}}\label{ipv6defrag_8h_a7e5d65bc976117147fc079ac6d18fc76}


Releases all resources used by an I\-Pv6 session. 


\begin{DoxyParams}{Parameters}
{\em session} & Session to be released \\
\hline
\end{DoxyParams}
\hypertarget{ipv6defrag_8h_ad4e3ffd4c74ea4ce8df171708c4a8a66}{\index{ipv6defrag.\-h@{ipv6defrag.\-h}!ntoh\-\_\-ipv6\-\_\-get\-\_\-size@{ntoh\-\_\-ipv6\-\_\-get\-\_\-size}}
\index{ntoh\-\_\-ipv6\-\_\-get\-\_\-size@{ntoh\-\_\-ipv6\-\_\-get\-\_\-size}!ipv6defrag.h@{ipv6defrag.\-h}}
\subsubsection[{ntoh\-\_\-ipv6\-\_\-get\-\_\-size}]{\setlength{\rightskip}{0pt plus 5cm}unsigned int ntoh\-\_\-ipv6\-\_\-get\-\_\-size (
\begin{DoxyParamCaption}
\item[{{\bf pntoh\-\_\-ipv6\-\_\-session\-\_\-t}}]{session}
\end{DoxyParamCaption}
)}}\label{ipv6defrag_8h_ad4e3ffd4c74ea4ce8df171708c4a8a66}


Gets the size of the flows table (max allowed flows) 


\begin{DoxyParams}{Parameters}
{\em session} & I\-Pv6 Session \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The max. amount of I\-Pv6 flows that can be stored , or zero on error
\end{DoxyReturn}
Gets the size of the flows table (max allowed flows) \hypertarget{ipv6defrag_8h_a2f57f546b934e37305aff7e968251b5d}{\index{ipv6defrag.\-h@{ipv6defrag.\-h}!ntoh\-\_\-ipv6\-\_\-get\-\_\-tuple4@{ntoh\-\_\-ipv6\-\_\-get\-\_\-tuple4}}
\index{ntoh\-\_\-ipv6\-\_\-get\-\_\-tuple4@{ntoh\-\_\-ipv6\-\_\-get\-\_\-tuple4}!ipv6defrag.h@{ipv6defrag.\-h}}
\subsubsection[{ntoh\-\_\-ipv6\-\_\-get\-\_\-tuple4}]{\setlength{\rightskip}{0pt plus 5cm}unsigned int ntoh\-\_\-ipv6\-\_\-get\-\_\-tuple4 (
\begin{DoxyParamCaption}
\item[{struct ip6\-\_\-hdr $\ast$}]{ip, }
\item[{{\bf pntoh\-\_\-ipv6\-\_\-tuple4\-\_\-t}}]{tuple}
\end{DoxyParamCaption}
)}}\label{ipv6defrag_8h_a2f57f546b934e37305aff7e968251b5d}


Gets the tuple4 of a I\-Pv6 flow. 


\begin{DoxyParams}{Parameters}
{\em ip} & Pointer to the I\-Pv6 header \\
\hline
{\em tuple} & Pointer to the output tuple4 struct \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
N\-T\-O\-H\-\_\-\-O\-K on success or the corresponding error code
\end{DoxyReturn}
Gets the tuple4 of a I\-Pv6 flow. \begin{DoxyRefDesc}{Todo}
\item[\hyperlink{todo__todo000001}{Todo}]\-: only checks the first header, should we verify them all? \end{DoxyRefDesc}
\hypertarget{ipv6defrag_8h_ab0a121ef041811b426b17ee60bd33ebd}{\index{ipv6defrag.\-h@{ipv6defrag.\-h}!ntoh\-\_\-ipv6\-\_\-init@{ntoh\-\_\-ipv6\-\_\-init}}
\index{ntoh\-\_\-ipv6\-\_\-init@{ntoh\-\_\-ipv6\-\_\-init}!ipv6defrag.h@{ipv6defrag.\-h}}
\subsubsection[{ntoh\-\_\-ipv6\-\_\-init}]{\setlength{\rightskip}{0pt plus 5cm}void ntoh\-\_\-ipv6\-\_\-init (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{ipv6defrag_8h_ab0a121ef041811b426b17ee60bd33ebd}


Initializes the I\-Pv6 defragmentation. 



Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=318pt]{ipv6defrag_8h_ab0a121ef041811b426b17ee60bd33ebd_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=328pt]{ipv6defrag_8h_ab0a121ef041811b426b17ee60bd33ebd_icgraph}
\end{center}
\end{figure}


\hypertarget{ipv6defrag_8h_a5dff4b25bcf2a68eb347356f57004027}{\index{ipv6defrag.\-h@{ipv6defrag.\-h}!ntoh\-\_\-ipv6\-\_\-new\-\_\-flow@{ntoh\-\_\-ipv6\-\_\-new\-\_\-flow}}
\index{ntoh\-\_\-ipv6\-\_\-new\-\_\-flow@{ntoh\-\_\-ipv6\-\_\-new\-\_\-flow}!ipv6defrag.h@{ipv6defrag.\-h}}
\subsubsection[{ntoh\-\_\-ipv6\-\_\-new\-\_\-flow}]{\setlength{\rightskip}{0pt plus 5cm}{\bf pntoh\-\_\-ipv6\-\_\-flow\-\_\-t} ntoh\-\_\-ipv6\-\_\-new\-\_\-flow (
\begin{DoxyParamCaption}
\item[{{\bf pntoh\-\_\-ipv6\-\_\-session\-\_\-t}}]{session, }
\item[{{\bf pntoh\-\_\-ipv6\-\_\-tuple4\-\_\-t}}]{tuple4, }
\item[{{\bf pipv6\-\_\-dfcallback\-\_\-t}}]{function, }
\item[{void $\ast$}]{udata, }
\item[{unsigned int $\ast$}]{error}
\end{DoxyParamCaption}
)}}\label{ipv6defrag_8h_a5dff4b25bcf2a68eb347356f57004027}


Adds a new I\-Pv6 flow. 


\begin{DoxyParams}{Parameters}
{\em tuple4} & Flow information \\
\hline
{\em function} & User defined function to receive defragmented datagrams \\
\hline
{\em count\-\_\-max} & Max. fragments allowed \\
\hline
{\em udata} & User defined data associated with this flow \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A pointer to the new created flow 
\end{DoxyReturn}
\hypertarget{ipv6defrag_8h_a2cddaf8d48fbba5e5702b3fac5f02ece}{\index{ipv6defrag.\-h@{ipv6defrag.\-h}!ntoh\-\_\-ipv6\-\_\-new\-\_\-session@{ntoh\-\_\-ipv6\-\_\-new\-\_\-session}}
\index{ntoh\-\_\-ipv6\-\_\-new\-\_\-session@{ntoh\-\_\-ipv6\-\_\-new\-\_\-session}!ipv6defrag.h@{ipv6defrag.\-h}}
\subsubsection[{ntoh\-\_\-ipv6\-\_\-new\-\_\-session}]{\setlength{\rightskip}{0pt plus 5cm}{\bf pntoh\-\_\-ipv6\-\_\-session\-\_\-t} ntoh\-\_\-ipv6\-\_\-new\-\_\-session (
\begin{DoxyParamCaption}
\item[{unsigned int}]{max\-\_\-flows, }
\item[{unsigned long}]{max\-\_\-mem, }
\item[{unsigned int $\ast$}]{error}
\end{DoxyParamCaption}
)}}\label{ipv6defrag_8h_a2cddaf8d48fbba5e5702b3fac5f02ece}


Creates a new session with independent parameters to reassemble T\-C\-P segments. 


\begin{DoxyParams}{Parameters}
{\em max\-\_\-flows} & Max number of allowed flows in this session \\
\hline
{\em max\-\_\-mem} & Max. amount of memory used by the session \\
\hline
{\em error} & Returned error code \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A pointer to the new session or 0 when it fails 
\end{DoxyReturn}


Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{ipv6defrag_8h_a2cddaf8d48fbba5e5702b3fac5f02ece_cgraph}
\end{center}
\end{figure}


